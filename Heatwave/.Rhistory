library(lubridate)
library(ggplot2)
library(stringr)
# 1️⃣ Load data
dat <- read_sheet("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
# 2️⃣ Parse Date safely
dat <- dat %>%
mutate(Date = parse_date_time(Date, orders = c("mdy", "dmy", "ymd"))) %>%
filter(!is.na(Date))
# 3️⃣ Separate Sample
morph <- dat %>%
separate(Sample, into = c("Bact", "Temp", "Salinity"), sep = "_", remove = FALSE) %>%
mutate(
Rep  = str_sub(Bact, start = -1),
Bact = str_sub(Bact, end = -2)
)
# 4️⃣ Pivot longer and calculate relative abundance
rel_abund_by_rep <- morph %>%
pivot_longer(
cols = -c(Bact, Temp, Rep, Salinity, Date, Sample),  # pivot only numeric columns
names_to = "category",
values_to = "val"
) %>%
filter(category != "total_images") %>%
group_by(Bact, Temp, Rep, Salinity, Date) %>%
mutate(
sumcount = sum(val, na.rm = TRUE),
percent  = val / sumcount
) %>%
ungroup()
# 5️⃣ Check for presence of "Cyst" category
if("exploding" %in% rel_abund_by_rep$category){
# Filter for Cyst and remove NAs
cyst_data <- rel_abund_by_rep %>%
filter(category == "exploding") %>%
filter(!is.na(percent))
if(nrow(cyst_data) > 0){
# Plot
ggplot(cyst_data, aes(x = Date, y = percent, color = Bact)) +
geom_point() +
facet_grid(Salinity ~ Temp) +
theme_bw() +
theme(
panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()
) +
ggtitle("Relative Abundance of Exploding Cells by Replicate") +
ylab("Percent of total counts")
} else {
message("No rows with valid 'exploding' data to plot.")
}
} else {
message("No 'exploding' category present in the dataset!")
}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <-  read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
dat$Date <- mdy(dat$Date)
morph <- dat %>%
separate(Sample, into = c("Bact", "Temp", "Salinity"), sep = "_") %>%
mutate(
Rep = str_sub(Bact, start = -1),   # last character = replicate
Bact = str_sub(Bact, end = -2)     # remove last two characters from Bact
)
morph$Bact <- str_sub(morph$Bact, end=-2)
library(googlesheets4)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(stringr)
dat <- read_sheet("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
dat <- dat %>%
mutate(
Date = parse_date_time(Date, orders = c("mdy", "dmy", "ymd"))
) %>%
filter(!is.na(Date))   # remove rows that couldn't be parsed
if(nrow(dat) == 0) stop("No valid Date values found in your data!")
morph <- dat %>%
separate(Sample, into = c("Bact", "Temp", "Salinity"), sep = "_", remove = FALSE) %>%
mutate(
Rep  = str_sub(Bact, start = -1),
Bact = str_sub(Bact, end = -2)
)
morph_long <- morph %>%
pivot_longer(
cols = -c(Sample, Bact, Temp, Rep, Salinity, Date),
names_to = "category",
values_to = "count"
) %>%
filter(category %ni% c("Partial", "Empty.Image")) %>%   # remove unwanted categories
mutate(
count    = as.numeric(count),
Temp     = factor(Temp),
Salinity = factor(Salinity),
Bact     = factor(Bact)
) %>%
filter(!is.na(Temp) & !is.na(Salinity) & !is.na(Bact) & !is.na(count) & count > 0)
if(nrow(morph_long) == 0) stop("No valid rows left for plotting after filtering!")
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
plot_by_day <- function(data, day_column, value_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:6,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:27,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:25,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:26,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Call function
plot_by_day(data, "10/06/2025" "RFU")
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:26,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Call function
plot_by_day(data, "10/06/2025", "RFU")
#Function definition
plot_by_day <- function(data, day_column, RFU_column) {
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
}
#Data
data <- data.frame(
day = as.Date('10/06/2025') + 0:26,
value = c(402.81,337.22, 482.61, 203.77, 328.68, 425.46, 2017.88, 1146.45, 1395.62, 1273.16, 892.7, 794.61, 350.42, 238.58, 507.21, 2702.85, 2706.51, 2418.39, 194.2, 130.71, 143, 2321.19, 1486.75, 1657.84, 615.39, 894.35, 946.32)
)
#Call function
plot_by_day(data, "09/24/2025", "RFU")
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(10/06/25)
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(59)
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(rounds = c(2, 5))
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(rounds = c(1, 3, 4, 5))
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(rounds = c(1, 3, 4, 5))
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(rounds = c(1, 3, 4, 5))
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
plot_by_day(rounds = c(1, 3, 4, 5))
new_plot <- function(ggsave("plot_by_day", width = 10, height = 8))
