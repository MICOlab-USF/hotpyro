deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1029.jpg", width = 10, height = 8)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1029.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1103.jpg", width = 10, height = 8)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1103.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1105.jpg", width = 10, height = 8)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1105.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1107.jpg", width = 10, height = 8)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
hottrial %>%
filter(Round %in% c(2, 3, 4)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x")
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "gold" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "darkgoldenrod" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "darkgoldenrod1" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1107.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1110.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1110.jpg", width = 10, height = 8)
