# Read df2 from text
df2 <- read.csv(text = df2_text)
# Clean and align df2 AFTER renaming
df2_clean <- df2 %>%
rename(
bact1 = Isolate,
N = Nitrogen
) %>%
mutate(
Round = Transfer,  # If Round is equivalent to Transfer
ID = paste(bact1, N, Round, Rep, sep = "_")
) %>%
select(bact1, N, Rep, Transfer, Round, ID, mumax)
df2_clean <- df2_clean %>%
mutate(bact1 = ifelse(bact1 == "LD", "LL", bact1))
df2_clean <- df2_clean %>%
mutate(ID = paste(bact1, N, Round, Rep, sep = "_"))
df2_clean <- df2 %>%
rename(
bact1 = Isolate,
N = Nitrogen
) %>%
select(bact1, N, Rep, Transfer, ID, mumax)
# First make sure both df1 and df2_clean have the same columns
df1 <- df1 %>%
mutate(Transfer = Round) %>%
select(bact1, N, Rep, Transfer, Round, ID, mumax)
# Combine NH4 and NO3 data
combined_df <- bind_rows(df1, df2_clean)
combined_df <- combined_df %>%
mutate(bact1 = ifelse(bact1 == "LD", "LL", bact1))
library(ggplot2)
ggplot(combined_df, aes(x = N, y = mumax, fill = bact1)) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, width = 0.6) +
geom_jitter(aes(color = bact1), width = 0.2, size = 2, alpha = 0.6) +
labs(
title = "Growth rate (μmax) by Nitrogen Type and Isolate",
x = "Nitrogen Source",
y = "Growth Rate (μmax)",
fill = "Isolate",
color = "Isolate"
) +
theme_minimal(base_size = 14)
table(combined_df$bact1, combined_df$N)
library(dplyr)
library(ggplot2)
# --- Clean df1: already has Round = 1 or 3 (NH4) ---
df1 <- df1 %>%
mutate(
Round = case_when(
Round == 1 ~ 1,
Round == 3 ~ 2
),
Transfer = Round,
N = trimws(as.character(N))  # Remove extra spaces
) %>%
select(bact1, N, Rep, Transfer, Round, ID, mumax)
# --- Clean df2: Transfer == 1 or 2 (NO3) ---
df2_clean <- df2 %>%
rename(
bact1 = Isolate,
N = Nitrogen
) %>%
mutate(
Round = case_when(
Transfer == 1 ~ 1,
Transfer == 2 ~ 2
),
bact1 = ifelse(bact1 == "LD", "LL", bact1),
ID = paste(bact1, N, Round, Rep, sep = "_"),
N = trimws(as.character(N))  # Remove extra spaces
) %>%
select(bact1, N, Rep, Transfer, Round, ID, mumax)
# --- Combine both datasets ---
combined_df <- bind_rows(df1, df2_clean)
# --- Plot ---
ggplot(combined_df, aes(x = N, y = mumax, fill = bact1)) +
geom_boxplot(alpha = 0.7, outlier.shape = NA, width = 0.6) +
geom_jitter(aes(color = bact1), width = 0.2, size = 2, alpha = 0.6) +
labs(
title = "Growth rate by Nitrogen Type and Isolate",
x = "Nitrogen Source",
y = "Growth Rate (μmax)",
fill = "Isolate",
color = "Isolate"
) +
facet_grid(~Transfer) +
scale_x_discrete(labels = c(
"NO3" = expression(NO[3]),
"NH4" = expression(NH[4])
)) +
scale_fill_manual(values = c("gold", "purple")) +
scale_color_manual(values = c("gold", "purple")) +
theme_test(base_size = 14)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1112.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1114.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1117.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1119.jpg", width = 10, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3",
Round == 5 ~ "S.T. 4"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1119.jpg", width = 11, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C and 31°C") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in warming temperatures") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1124.jpg", width = 11, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in warming temperatures") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1201.jpg", width = 11, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in warming temperatures") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1203.jpg", width = 11, height = 8)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in warming temperatures") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
hottrial %>%
filter(Round %in% c(2, 3, 4, 5, 6, 7)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1",
Round == 4 ~ "S.T. 2 in 31°C",
Round == 5 ~ "S.T. 3",
Round == 6 ~ "S.T. 4 in 32°C",
Round == 7 ~ "S.T. 5"
)) %>%
ggplot(aes(x = Day, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in warming temperatures") +
facet_grid(~ Round_label, scales = "free_x") +
geom_smooth(se = FALSE) +
scale_color_manual(values = c("forestgreen", "burlywood" ))
ggsave("hotonestrial_1205.jpg", width = 13, height = 8)
