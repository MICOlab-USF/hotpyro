knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
View(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
str(ammonium_trial)
?separate
ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>% ggplot(aes(x=Day, y = RFU)) + geom_point()
ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>% ggplot(aes(x=Day, y = RFU, color = bact)) + geom_point() + theme_test() + facet_grid(~Round)
ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE)
mutate(bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact))
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE)
View(amm)
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact))
"%ni%" <- Negate("%in%")
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point() + theme_test() + facet_grid(~Round)
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point() + theme_test() + facet_grid(~Round)
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point() + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point() + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth()
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE)
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) + geom_vline(x=22)
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) + geom_vline(xintercept=22)
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) + scale_y_log10()
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1001.jpg", width = 10, height = 8)
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "1", Culture == "LL_1006 7/23" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "1", Culture == "LL_1006 7/23" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>% filter(Round == "2") %>% ggplot(aes(x = Date, y = RFU, color = Culture))+
geom_point () +
theme_test () +
ggtitle ("Pyrodinium growth in 30°C ")
hottrial %>% filter(Round == "2") %>% ggplot(aes(x = Date, y = RFU, color = Culture))+
geom_point () +
theme_test () +
ggtitle ("Pyrodinium growth in 30°C ")
facet_grid(~ case_when(
Round == 2 ~ "S.T. 1 (Round 3)",
Round == 3 ~ "S.T. 2 (Round 4)",
TRUE       scales = "free_x")
hottrial %>% filter(Round == "2") %>% ggplot(aes(x = Date, y = RFU, color = Culture))+
geom_point () +
theme_test () +
ggtitle ("Pyrodinium growth in 30°C ") +
facet_grid(~ case_when(
Round == 2 ~ "S.T. 1 (Round 3)",
Round == 3 ~ "S.T. 2 (Round 4)",
TRUE       scales = "free_x")
hottrial %>% filter(Round == "2") %>% ggplot(aes(x = Date, y = RFU, color = Culture))+
geom_point () +
theme_test () +
ggtitle ("Pyrodinium growth in 30°C ") +
facet_grid(~ case_when(
Round == 2 ~ "S.T. 1 (Round 3)",
Round == 3 ~ "S.T. 2 (Round 4)"
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label)
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label) +
scales = free_x
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label) +
scales = "free_x"
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label) +
scales = "free_x")
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1001.jpg", width = 7, height = 6)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1001.jpg", width = 7, height = 6)
knitr::opts_chunk$set(echo = TRUE)
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
pyro_morph %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
pyro_morph %>% dat %>% group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
pyro_morph <- dat %>%
group_by(Treatment) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
names(dat)
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
pyro_morph<- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Treatment) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
pyro_morph <- dat %>%
group_by(Treatment) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Treatment, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic()
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic()
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic() %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(tidyr)
dat <- dat %>%
separate(Sample, into = c("Light", "Nutrient", "Temp", "Rep"), sep = "_")
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(tidyr)
dat <- dat %>%
separate(Sample, into = c("Light", "Nutrient", "Temp", "Rep"), sep = "_")
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
