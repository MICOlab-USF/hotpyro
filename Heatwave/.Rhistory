par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from LL 7/23" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from LL 7/23" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "1", Culture == "OTB_1006 6/10" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "1", Culture == "OTB_1006 6/10" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=10, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from OTB 6/10" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from OTB 6/10" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", Round == 1, salinity == 25, N == "NH4") %>%
as.data.frame()
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20,25)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
Round == 5 ~ "S.T. 3 (Round 5)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "2") %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(4)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
amm <- ammonium_trial %>% filter(Round %in% c(2)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
`%ni%` <- Negate(`%in%`)
#Function Definition
plot_by_day <- function(data = ammonium_trial, rounds = c(1, 3, 4, 5)) {
#Data
amm <- data %>%
filter(Round %in% rounds) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
#Plot
plot <- ggplot(amm, aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold"))
# + scale_y_log10()
return(plot)
}
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "1", Culture == "LL_1006 7/23" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "1", Culture == "LL_1006 7/23" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from LL 7/23" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from LL 7/23" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "1", Culture == "OTB_1006 6/10" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "1", Culture == "OTB_1006 6/10" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=10, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
library(ggplot2)
library(dplyr)
ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from OTB 6/10" ) %>% ggplot(aes(x = Date, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination"))
library(growthrates)
rnd1 <- ammonium_trial %>% filter(Round == "3", Culture == "S.T. 1 from OTB 6/10" ) %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
splitted.data <- multisplit(rnd1, c("Rep"))
dat <- splitted.data[[1]]
dat <- dat %>%
mutate(Time = as.numeric(difftime(Date,min(Date),units = "days")))
fit <- fit_easylinear(dat$Time, dat$RFU)
summary(fit)
coef(fit) # exponential growth parameters
rsquared(fit)  # coefficient of determination (of log-transformed data)
deviance(fit)  # residual sum of squares of log-transformed data
par(mfrow = c(1, 2))
plot(fit, log = "y")
plot(fit)
fitx <- fit_easylinear(dat$Time, dat$RFU, h = 8, quota = 0.95)
plot(fit, log = "y")
lines(fitx, pch = "+", col = "blue")
all<- all_easylinear(RFU~Time | Rep, data = rnd1, h=6, quota = 1 )
par(mfrow = c(1,3))
par(mar= c(1,1,1,1))
plot(all, log="y")
res<- results(all)
res
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", Round == 1, salinity == 25, N == "NH4") %>%
as.data.frame()
gr_LL_rd1$Round <- 1
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
as.data.frame()
gr_LL_rd1$Round <- 1
mean_res1 <- res1 %>% group_by(bact1, N, Round, Rep) %>%
dplyr::summarize(mean_gr = mean(mumax), sd = sd(mumax))
mean_res1 <- group_by(bact1, N, Round, Rep) %>%
dplyr::summarize(mean_gr = mean(mumax), sd = sd(mumax))
mean_res1 <- group_by(bact1, N, Round, Rep) %>%
dplyr::summarize(mean_gr = mean(mumax), sd = sd(mumax))
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
as.data.frame()
gr_LL_rd1$Round <- 1
mean_res1 <- group_by(bact1, N, Round, Rep) %>%
dplyr::summarize(mean_gr = mean(mumax), sd = sd(mumax))
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4, 5)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
as.data.frame()
gr_LL_rd1$Round <- 1
mean_res1 <- group_by(bact1, N, Round, Rep) %>%
dplyr::summarize(mean_gr = mean(mumax), sd = sd(mumax))
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)  # for theme_test()
library(dplyr)
library(tidyr)
library(ggplot2)
# Define %ni% operator if not already defined
`%ni%` <- Negate(`%in%`)
amm <- ammonium_trial %>%
filter(Round %in% c(1, 3, 4, 5)) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
# Plotting RFU by Day, colored by bact1, faceted by Round
amm %>%
ggplot(aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold")) +
geom_smooth(se = FALSE)
# Filter for specific subset
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
as.data.frame()
# Add Round column explicitly (optional, since Round should already be there)
gr_LL_rd1$Round <- 1
# Calculate summary stats grouped by bact1, N, Round, Rep (using filtered data)
mean_res1 <- gr_LL_rd1 %>%
group_by(bact1, N, Round, Rep) %>%
summarize(
mean_gr = mean(mumax, na.rm = TRUE),
sd = sd(mumax, na.rm = TRUE),
.groups = "drop"
)
library(dplyr)
library(tidyr)
library(ggplot2)
# Define %ni% operator if not already defined
`%ni%` <- Negate(`%in%`)
amm <- ammonium_trial %>%
filter(Round %in% c(1, 3, 4, 5)) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
# Plotting RFU by Day, colored by bact1, faceted by Round
amm %>%
ggplot(aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold")) +
geom_smooth(se = FALSE)
# Filter for specific subset
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
mutate(mumax = 0.1677532) %>%
as.data.frame()
# Add Round column explicitly (optional, since Round should already be there)
gr_LL_rd1$Round <- 1
# Calculate summary stats grouped by bact1, N, Round, Rep (using filtered data)
mean_res1 <- gr_LL_rd1 %>%
group_by(bact1, N, Round, Rep) %>%
summarize(
mean_gr = mean(mumax, na.rm = TRUE),
sd = sd(mumax, na.rm = TRUE),
.groups = "drop"
)
library(dplyr)
library(tidyr)
library(ggplot2)
# Define %ni% operator if not already defined
`%ni%` <- Negate(`%in%`)
amm <- ammonium_trial %>%
filter(Round %in% c(1, 3, 4, 5)) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
# Plotting RFU by Day, colored by bact1, faceted by Round
amm %>%
ggplot(aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold")) +
geom_smooth(se = FALSE)
# Filter for specific subset
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
mutate(mumax = 0.1677532) %>%
as.data.frame()
# Add Round column explicitly (optional, since Round should already be there)
gr_LL_rd1$Round <- 1
# Calculate summary stats grouped by bact1, N, Round, Rep (using filtered data)
mean_res1 <- gr_LL_rd1 %>%
group_by(bact1, N, Round, Rep) %>%
summarize(
mean_gr = mean(mumax, na.rm = TRUE),
sd = sd(mumax, na.rm = TRUE),
.groups = "drop"
)
"ID" = paste0(bact1, N, Round, Rep), sep = "_"
library(dplyr)
library(tidyr)
library(ggplot2)
# Define %ni% operator if not already defined
`%ni%` <- Negate(`%in%`)
amm <- ammonium_trial %>%
filter(Round %in% c(1, 3, 4, 5)) %>%
separate(Culture, into = c("bact"), sep = "_", remove = FALSE) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>%
mutate(
bact1 = case_when(
bact %in% c("LL", "OTB") ~ bact,
bact %ni% c("LL", "OTB") ~ bact1
)
)
# Plotting RFU by Day, colored by bact1, faceted by Round
amm %>%
ggplot(aes(x = Day, y = RFU, color = bact1)) +
geom_point(alpha = 0.8) +
theme_test() +
facet_grid(~Round) +
scale_color_manual(values = c("cornflowerblue", "gold")) +
geom_smooth(se = FALSE)
# Filter for specific subset
gr_LL_rd1 <- amm %>%
filter(bact1 == "LL", N == "NH4", Round == 1, Rep == 1) %>%
mutate(mumax = 0.1677532) %>%
as.data.frame()
# Add Round column explicitly (optional, since Round should already be there)
gr_LL_rd1$Round <- 1
# Calculate summary stats grouped by bact1, N, Round, Rep (using filtered data)
mean_res1 <- gr_LL_rd1 %>%
group_by(bact1, N, Round, Rep) %>%
summarize(
mean_gr = mean(mumax, na.rm = TRUE),
sd = sd(mumax, na.rm = TRUE),
.groups = "drop"
)
library(dplyr)
df1 <- df1 %>%
mutate(ID = paste(bact1, N, Round, Rep, sep = "_"))
