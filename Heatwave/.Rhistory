mutate(percent_cyst = (cyst / total_images) * 100)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Treatment) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
pyro_morph <- dat %>%
group_by(Treatment) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Treatment, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic()
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic()
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic() %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(tidyr)
dat <- dat %>%
separate(Sample, into = c("Light", "Nutrient", "Temp", "Rep"), sep = "_")
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
library(dplyr)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
library(tidyr)
dat <- dat %>%
separate(Sample, into = c("Light", "Nutrient", "Temp", "Rep"), sep = "_")
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
pyro_morph <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n)
)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst = sd(percent_cyst, na.rm = TRUE),
n = n(),
se_cyst = sd_cyst / sqrt(n))
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
knitr::opts_chunk$set(echo = TRUE)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme_classic()
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate($Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
...
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
`%ni%` <- Negate(`%in%`)   # define "not in" operator
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
`%ni%` <- Negate(`%in%`)   # define "not in" operator
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat%>% filter(Sample == "LD_H_20") %>%ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat%>% filter(Sample == "LD_H_20") %>% ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
ggplot(dat, aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
library(stringr)
ggplot(dat %>% filter(str_starts(Sample, "LD")),
aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat %>% filter(str_starts(Sample, "LD")),
aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
ggplot(dat, aes(x = Sample, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "red") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat, aes(x = Sample, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "red") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat, aes(x = Sample, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat, aes(x = bact1, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat, aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(summary_dat), aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(summary_dat, aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
dat <- dat %>%
separate(Sample, into = c("x","y","z","bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
library(stringr)
ggplot(dat %>% filter(str_starts(Sample, "LD")),
aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- read_sheet ("https://docs.google.com/spreadsheets/d/1KcAYb0czCxgbFpE-7DaJSv4EGLgqm6xgdZbpPmvlkNc/edit?usp=sharing")
str(pyro_morph)
names(dat)
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
library(stringr)
ggplot(dat %>% filter(str_starts(Sample, "LD")),
aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
mutate(percent_cyst = (cyst / total_images) * 100)
summary_dat <- dat %>%
group_by(Sample) %>%
summarise(
mean_cyst = mean(percent_cyst, na.rm = TRUE),
sd_cyst   = sd(percent_cyst, na.rm = TRUE),
n         = n(),
se_cyst   = sd_cyst / sqrt(n),
.groups   = "drop"
)
dat <- dat %>%
separate(Sample, into = c(bact"), sep = "_", remove = FALSE)
dat <- dat %>%
separate(Sample, into = c(bact"), sep = "_", remove = FALSE)
library(stringr)
ggplot(dat %>% filter(str_starts(Sample, "LD")),
aes(x = Sample, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "red") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(summary, aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(summary), aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(summary, aes(x = bact, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "blue") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
pyro_morph <- summary_dat %>% separate(Sample, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LD", "OTB") ~ bact, bact %ni% c("LD", "OTB") ~ bact1))
ggplot(dat, aes(x = Sample, y = percent_cyst)) + geom_jitter(width = 0.2, alpha = 0.5) + stat_summary(fun = mean, geom = "point", size = 3, color = "red") + labs(y = "% Cysts", x = "Sample") + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_classic()
dat <- dat %>%
separate(Sample, into = c("x","y","z","bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
dat <- dat %>%
separate(Sample, into = c("bact"), sep = "_", remove = FALSE)
ggplot(dat, aes(x = bact, y = percent_cyst)) +
geom_jitter(width = 0.2, alpha = 0.5) +
stat_summary(fun = mean, geom = "point", size = 3, color = "blue") +
labs(y = "% Cysts", x = "Sample") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme_classic()
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
library(growthrates)
ammonium_trial<-read_sheet("https://docs.google.com/spreadsheets/d/1QRzU9teNRcPwRhmw8oUkU11Vfzaa26bnVQpcDRTGL2E/edit?usp=sharing")
ammonium_trial$Date <- ymd(ammonium_trial$Date)
ammonium_trial$Rep <- as.character(ammonium_trial$Rep)
ammonium_trial$RFU <- as.numeric(ammonium_trial$RFU)
data(ammonium_trial)
str(ammonium_trial)
head(ammonium_trial)
ammonium_trial %>% ggplot(aes(x = Day, y = RFU, color = Culture, shape = factor (Round)) ) +
geom_point () +
theme_test () +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_shape_manual(values = c(16,4,15,20)) +
ggtitle(expression("Pyrodinium growth with " * NH[4]^"+" * " addition and " * NO[3]^"-" * " elimination")) +
facet_grid(~ case_when(
Round == 3 ~ "S.T. 1 (Round 3)",
Round == 4 ~ "S.T. 2 (Round 4)",
TRUE       ~ "Rounds 1 and 2"), scales = "free_x")
"%ni%" <- Negate("%in%")
amm <- ammonium_trial %>% filter(Round %in% c(1, 3, 4)) %>% separate(Culture, into = c("bact"), sep = "_", remove = FALSE ) %>%
separate(bact, into = c("x", "y", "z", "bact1"), sep = " ", remove = FALSE) %>% mutate(bact1 = case_when(bact %in% c("LL", "OTB") ~ bact, bact %ni% c("LL", "OTB") ~ bact1))
amm %>% ggplot(aes(x=Day, y = RFU, color = bact1)) + geom_point(alpha = 0.8) + theme_test() + facet_grid(~Round) + scale_color_manual(values = c("cornflowerblue", "gold" ))+ geom_smooth(se = FALSE) #+ scale_y_log10()
ggsave("ammoniumtrialclean_1003.jpg", width = 10, height = 8)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(purrr)
"%ni%" <- Negate("%in%")
library(googlesheets4)
library(patchwork)
hottrial<- read_sheet("https://docs.google.com/spreadsheets/d/18_2ZNyk1GvUCoxckpurD9vz5-bD_RSRSeCNKY0YZf04/edit?usp=sharing")
hottrial$Date <- ymd(hottrial$Date)
hottrial$Rep <- as.character(hottrial$Rep)
hottrial$RFU <- as.numeric(hottrial$RFU)
hottrial %>%
filter(Round %in% c(2, 3)) %>%
mutate(Round_label = case_when(
Round == 2 ~ "Round 1 in 30°C",
Round == 3 ~ "S.T. 1"
)) %>%
ggplot(aes(x = Date, y = RFU, color = Culture)) +
geom_point() +
theme_test() +
ggtitle("Pyrodinium growth in 30°C") +
facet_grid(~ Round_label, scales = "free_x")
ggsave("hotonestrial_1003.jpg", width = 7, height = 6)
